---
title: "AVE_Notebook"
output: html_notebook
---

```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
library(dplyr)
renfeDF <- read.csv(file = "~/Documents/GitHub/AVE-Study/renfe.csv")
renfeDF <- na.omit(renfeDF) 
renfeDF <- filter(renfeDF, price != 0)
attach(renfeDF)
```

```{r paged.print=TRUE}
library(psych)
describe(price)
```

En este primer analisis podemos determinar la media, mediana, deviacion estandar, kurtosis y el rango de los datos sin discriminar ninguna variable cualitativa. Podemos ver que la mediana de los precios es 58,15 Euros y que el maximo de todos los datos es 342 Euros.

Vamos a empezar a analizar las variables categoricas de los datos, analizando el precio en funcion del tipo de asiento (Turista, Preferente, Cama, ...)

```{r paged.print=FALSE}
describeBy(renfeDF$price, renfeDF$train_type)
```
```{r paged.print=FALSE}
describeBy(renfeDF$price, renfeDF$train_class)
```

A continuacion vamos a utilizar la libreria fitdistrplus para ver si los datos se pueden asemejar a una distribucion de datos conocida. Para eso utilizamos el comando descdist que nos presenta un grafico de Cullen y Frey.

```{r}
library(fitdistrplus)
descdist(renfeDF$price)
```

Vemos que los datos se podrian asemejar a una lognormal o incluso a una distribucion gamma. Vamos a decidir numericamente si los datos se pueden asemejar a una distribucion normal usando el test de Shapiro-Wilkinson.

```{r}
library(fitdistrplus)
shapiro.test(renfeDF$price[1:5000])
```
Podemos asumir que los datos no se asemejan a una normal ya que el p-value obtenido del test de Shapiro-Wilkinson es menor que 0.05

Ahora vamos a modificar los datos usando una transformacion logaritmica para ver si conseguimos que se asemeje a una distribucion normal.


```{r echo=FALSE, message=FALSE, warning=FALSE}
library(fitdistrplus)
logPrice <- log(renfeDF$price)
descdist(logPrice)
```

Al hacer la transformacion de los datos podemos ver que los datos ahora se asemejan a una normal tras realizar una transformacion logaritmica sobre el precio. Ahora mostramos un histograma sobre los datos transformados para ver como se asemeja a una curva normal.

```{r}
library(rcompanion)
plotNormalHistogram(logPrice)
```

Podemos ver que excepto un par de valores que sobresalen por la curva normal, el conjunto de datos se comporta como una curva normal.